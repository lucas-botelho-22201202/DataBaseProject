-- <> create database <>
-------------------------
IF NOT EXISTS (SELECT name  FROM master.dbo.sysdatabases WHERE name = 'tfc')
BEGIN
    CREATE DATABASE tfc;
END;
GO

USE tfc;

-- <> create tables <> --
-------------------------
---- curso
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'Curso')
BEGIN
	CREATE TABLE Curso (
		id BIGINT NULL,
		nome VARCHAR(255) NULL);
END;
---- tecnologia
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'Tecnologia')
BEGIN
	CREATE TABLE Tecnologia (
		id BIGINT NULL,
		nome VARCHAR(255) NULL);
END;
---- disciplina
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'Disciplina')
BEGIN
	CREATE TABLE Disciplina (
		id BIGINT NULL,
		cursoAssociado BIGINT NULL,
		nome VARCHAR(255) NULL);
END;
---- aluno
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'Aluno')
BEGIN
	CREATE TABLE Aluno (
		id BIGINT NULL,
		curso VARCHAR(255) NULL,
		email VARCHAR(255) NULL,
		nome VARCHAR(255) NULL,
		numeroAluno VARCHAR(255) NULL,
		numeroContato INT NULL);
END;
---- avaliacao-disciplina-aluno
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'AvaliacaoDisciplinaAluno')
BEGIN
	CREATE TABLE AvaliacaoDisciplinaAluno (
		id BIGINT NULL,
		idNumeroAluno BIGINT NULL,
		idNumeroDisciplina BIGINT NULL,
		nota INT NULL);
END;
---- grupo
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'Grupo')
BEGIN
	CREATE TABLE Grupo (
		id BIGINT NULL,
		confirmaAluno1 TINYINT NULL,
		confirmaAluno2 TINYINT NULL,
		idNumeroAluno1 VARCHAR(255) NULL,
		idNumeroAluno2 VARCHAR(255) NULL);
END;
---- utilizador
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'Utilizador')
BEGIN
	CREATE TABLE Utilizador (
		id BIGINT NULL,
		coordenador TINYINT NULL,
		idIdentificacao VARCHAR(255) NULL,
		tipoUtilizador VARCHAR(255) NULL);
END;
---- inscricao
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'Inscricao')
BEGIN
	CREATE TABLE Inscricao (
		id BIGINT NULL,
		estado VARCHAR(255) NULL,
		idNumeroGrupo BIGINT NULL,
		idTFC VARCHAR(255) NULL,
		numeroAluno VARCHAR(255) NULL,
		ordemEscolha INT NULL,
		registoDeInscricao DATETIME NULL,
		publicado TINYINT NULL,
		anoLetivo VARCHAR(255) NULL);
END;
---- professor-deisi
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'ProfessorDEISI')
BEGIN
	CREATE TABLE ProfessorDEISI (
		id BIGINT NULL,
		email VARCHAR(255) NULL,
		nome VARCHAR(255) NULL,
		numeroContato INT NULL,
		numeroProfessor VARCHAR(255) NULL);
END;
---- professor-n-deisi
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'ProfessorNDEISI')
BEGIN
	CREATE TABLE ProfessorNDEISI (
		id BIGINT NULL,
		departamentoAfeto VARCHAR(255) NULL,
		email VARCHAR(255) NULL,
		idProfessor VARCHAR(255) NULL,
		nome VARCHAR(255) NULL,
		numeroContato INT NULL);
END;
---- empresa-entidade-externa
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'Empresa_EntidadeExterna')
BEGIN
	CREATE TABLE Empresa_EntidadeExterna (
		id BIGINT NULL,
		email VARCHAR(255) NULL,
		idEmpresa VARCHAR(255) NULL,
		interlocutor VARCHAR(255) NULL,
		morada VARCHAR(255) NULL,
		nome VARCHAR(255) NULL,
		numeroContato INT NULL);
END;
---- tfc
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'TFC')
BEGIN
	CREATE TABLE TFC (
		id BIGINT NULL,
		titulo VARCHAR(255) NULL,
		anoletivo VARCHAR(255) NULL,
		avaliacaoProposta VARCHAR(255) NULL,
		coorientador VARCHAR(255) NULL,
		dataEstado VARCHAR(255) NULL,
		dataProposta VARCHAR(255) NULL,
		descricao TEXT NULL,
		entidade BIGINT NULL,
		estado VARCHAR(255) NULL,
		idGrupo BIGINT NULL,
		idtfc VARCHAR(255) NULL,
		motivoRecusa VARCHAR(255) NULL,
		numeroInscricoes INT NULL,
		orientador VARCHAR(255) NULL,
		orientadorProposto VARCHAR(255) NULL,
		preponente VARCHAR(255) NULL,
		semestre INT NULL,
		tecnologias VARCHAR(255) NULL);
END;
---- tfc-curso
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'TFCCurso')
BEGIN
	CREATE TABLE TFCCurso (
		id BIGINT NULL,
		idCurso BIGINT NULL,
		idTFC BIGINT NULL);
END;
---- tfc-tecnologia
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'TFCTecnologia')
BEGIN
	CREATE TABLE TFCTecnologia (
		id BIGINT NULL,
		idTFC BIGINT NULL,
		idTecnologia BIGINT NULL);
END;
---- tfc-disciplina
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'TFCDisciplina')
BEGIN
	CREATE TABLE TFCDisciplina (
		id BIGINT NULL,
		idNumeroDisciplina BIGINT NULL,
		numeroTFC BIGINT NULL);
END;
---- historico-tfc
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'HistoricoTFC')
BEGIN
	CREATE TABLE HistoricoTFC (
		id BIGINT NULL,
		avaliacao VARCHAR(255) NULL,
		dataMudancaEstado VARCHAR(255) NULL,
		estado VARCHAR(255) NULL,
		idTFC VARCHAR(255) NULL,
		idTFCNumerico BIGINT NULL,
		utilizador VARCHAR(255) NULL);
END;

GO